# Chapter 09 주요 경제지표 그래프

## 📋 실습 개요
이번 장에서는 **API 활용과 데이터 시각화**를 통해 주요 경제지표를 분석하고 그래프로 표현하는 프로젝트를 진행합니다.
- **한국은행 ECOS API**를 활용한 실시간 경제지표 데이터 수집
- **pandas**를 사용한 체계적인 경제 데이터 처리 및 분석
- **matplotlib & seaborn**으로 전문적인 시계열 그래프 생성
- **엑셀 파일 다중 시트** 관리를 통한 효율적인 데이터 저장

## ⚙️ 패키지 설치
실습을 원활하게 진행하기 위해 비주얼 스튜디오 코드 터미널에서 아래 명령어를 실행하여 필요한 파이썬 패키지들을 설치해주세요.

```shell
pip install -U datakart matplotlib openpyxl pandas requests seaborn
```

## 🔑 ECOS API 키 준비하기
경제 데이터 수집을 위해서는 **한국은행 ECOS API 키**가 필요합니다. 다음 단계를 따라 준비해주세요:
1. [한국은행 경제통계시스템(ECOS)](https://ecos.bok.or.kr/) 접속
2. 회원가입 후 로그인
3. 'API 이용신청' 메뉴에서 인증키 발급
4. 발급받은 API 키를 해당 실습 파일의 `ECOS_KEY` 변수에 입력하세요

## 🚀 실습 단계별 가이드

*   **[step_1_1.py](step_1_1.py)**: 실습 결과물을 저장할 `output` 폴더를 생성하여 기본 작업 환경을 구성합니다.

*   **[step_1_2.py](step_1_2.py)**: `requests`를 사용하여 한국은행 경제통계시스템(ECOS)의 샘플 API를 호출하고, 그 결과를 JSON 형식으로 확인하는 기본 예제입니다.

*   **[step_2_1.py](step_2_1.py)**: `datakart` 패키지를 사용하여 ECOS API에서 특정 통계(기준금리) 데이터를 조회하고, `pandas` DataFrame으로 변환한 후 CSV 파일로 저장합니다. (API 키 필요)

*   **[step_2_2.py](step_2_2.py)**: 여러 개의 주요 경제 지표(기준금리, 국고채, 코스피 등)를 ECOS API로 한 번에 조회하여, 각각의 결과를 별도의 시트로 구성된 하나의 엑셀(.xlsx) 파일에 체계적으로 저장합니다.

*   **[step_3_1_datetime.py](step_3_1_datetime.py)**: `datetime` 모듈과 `pandas`의 `to_datetime` 함수를 사용하여 문자열을 날짜/시간 객체로 변환하고, 형식을 지정하는 방법을 익히는 기본 예제입니다.

*   **[step_3_1.py](step_3_1.py)**: `step_2_2.py`에서 저장한 엑셀 파일 중 '코스피지수' 시트를 읽어와서, `seaborn`과 `matplotlib`을 사용하여 전문적인 시계열 선 그래프를 그리고 이미지 파일(.png)로 저장합니다.

*   **[step_3_2_subplots.py](step_3_2_subplots.py)**: `matplotlib`의 `subplots` 기능을 활용하여 하나의 이미지 안에 바, 산점도, 선 그래프 등 여러 종류의 그래프를 함께 그리는 방법을 학습하는 기본 예제입니다.

*   **[step_3_2.py](step_3_2.py)**: 엑셀 파일에 저장된 4개의 경제 지표(국고채, 회사채, 코스피, 원달러환율)를 각각 읽어와서, `matplotlib`의 `subplots`를 이용해 2x2 격자로 배열된 여러 개의 미니 선 그래프를 하나의 이미지로 생성하고 저장합니다.

*   **[step_x.py](step_x.py)**: ECOS API에서 국고채와 회사채 금리 데이터를 조회하여 하나의 DataFrame으로 합친 후, `seaborn`의 `hue` 옵션을 사용하여 두 데이터를 구별되는 색상으로 표현한 선 그래프를 그리고 이미지 파일로 저장하는 종합 실습입니다.

모든 준비가 완료되었다면 주요 경제지표 그래프 실습을 시작해보세요! 🚀